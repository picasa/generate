% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/system_gis.R
\name{mask_lines}
\alias{mask_lines}
\title{Apply intersection masking using sliding window maximum}
\usage{
mask_lines(data, z = "z", n_lag = 100, threshold = 10)
}
\arguments{
\item{data}{dataframe with xn, y_rank, \{z\}s columns (from shift_lines)}

\item{z}{base column name (default "z"). Reads \{z\}s, produces \{z\}n and z_rank}

\item{n_lag}{search range for intersection detection (number of preceding lines)}

\item{threshold}{minimum allowed distance between lines (m)}
}
\value{
input dataframe with additional columns:
\itemize{
\item \code{z_rank}: rank of \{z\}s within each x-column (foreground = low rank)
\item \verb{\\\{z\\\}n}: masked elevation â€” equals \{z\}s where visible, NA where occluded
}
}
\description{
Step 3 of the ridge pipeline: for each x-column, marks a point as NA if its
shifted value \{z\}s is too close to any of the n_lag preceding values. Uses a
single roll_max instead of n_lag lag columns:
any(x - x_k < t) <-> x - max(x_k) < t
}
